---
version: "3"

tasks:
  run:
    desc: Run all test for both iOS and Android.
    cmds:
      - task: run:android
      - task: run:ios

  run:android:
    desc: Run tests for android.
    cmds:
      - cmd: lima nerdctl exec -e TEST_PLATFORM=Android -e TEST_ID={{.ANDROID_TEST_UUID}} -e ANDROID_APK={{.ANDROID_APK}} -e IOS_APP={{.IOS_APP}} mtest task python:local:test:android
        ignore_error: true

  run:ios:
    desc: Run tests for iOS.
    cmds:
      - cmd: lima nerdctl exec -e TEST_PLATFORM=IOS -e TEST_ID={{.IOS_TEST_UUID}} -e ANDROID_APK={{.ANDROID_APK}} -e IOS_APP={{.IOS_APP}} mtest task python:local:test:ios
        ignore_error: true
